#!/usr/bin/env python3
"""
Скрипт для генерации и записи 170 слов на тематику свадьбы и семьи в Google Sheets для Wordle
"""
import sys
import os

# Добавляем корневую директорию проекта в путь
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from google_sheets import get_google_sheets_client, GOOGLE_SHEETS_ID
import logging

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# 170 слов на тематику свадьбы и семьи (существительные в именительном падеже единственного числа)
WEDDING_WORDS = [
    # Основные понятия
    "СВАДЬБА", "БРАК", "СОЮЗ", "СЕМЬЯ", "ЛЮБОВЬ", "СЧАСТЬЕ", "РАДОСТЬ", "ПРАЗДНИК",
    
    # Участники
    "ЖЕНИХ", "НЕВЕСТА", "ГОСТИ", "СВИДЕТЕЛИ", "ТАМАДА", "ФОТОГРАФ", "ВИДЕОГРАФ", "ДЕКОРАТОР",
    "ФЛОРИСТ", "КОНДИТЕР", "МУЗЫКАНТ", "ВЕДУЩИЙ", "РОДИТЕЛИ", "СВЕКРОВЬ", "ТЕЩА", "ТЕСТЬ",
    "СВЕКОР", "СВАТ", "СВАТЬЯ", "ДРУЖКА", "ДРУЖКО", "ШАФЕР", "ПОДРУЖКА", "СВИДЕТЕЛЬНИЦА",
    
    # Одежда и аксессуары
    "ПЛАТЬЕ", "ФАТА", "КОСТЮМ", "ГАЛСТУК", "БАБОЧКА", "ТУФЛИ", "ТУФЕЛЬКИ", "ПЕРЧАТКИ",
    "БУКЕТ", "БУТОНЬЕРКА", "КОЛЬЦО", "ОБРУЧАЛЬНОЕ", "СЕРЬГИ", "ОЖЕРЕЛЬЕ", "БРАСЛЕТ",
    
    # Церемония
    "ЗАГС", "РОСПИСЬ", "ВЕНЧАНИЕ", "ЦЕРКОВЬ", "ХРАМ", "АЛТАРЬ", "ИКОНА", "СВЕЧА",
    "КЛЯТВА", "ОБЕТ", "ПРИЗНАНИЕ", "ПРЕДЛОЖЕНИЕ", "ПОМОЛВКА", "ОБРУЧЕНИЕ",
    
    # Празднование
    "БАНКЕТ", "РЕСТОРАН", "ЗАЛ", "СТОЛ", "СТУЛ", "СКАТЕРТЬ", "САЛФЕТКА", "ПОСУДА",
    "ТОРТ", "ПИРОЖНОЕ", "КОНФЕТА", "ШАМПАНСКОЕ", "ВИНО", "ТОСТ", "ПОЗДРАВЛЕНИЕ",
    "ПОДАРОК", "КОНВЕРТ", "ДЕНЬГИ", "ВАЗА", "СЕРВИЗ", "СТАКАН", "БОКАЛ", "РЮМКА",
    
    # Развлечения
    "ТАНЕЦ", "ВАЛЬС", "МУЗЫКА", "ПЕСНЯ", "ОРКЕСТР", "ДИДЖЕЙ", "ПЛОЩАДКА", "ПАРКЕТ",
    "КОНКУРС", "ИГРА", "ВИКТОРИНА", "ЛОТЕРЕЯ", "ПРИЗ", "СЮРПРИЗ", "ФЕЙЕРВЕРК",
    "САЛЮТ", "ЗВУК", "СВЕТ", "ПРОЖЕКТОР", "МИКРОФОН", "КОЛОНКА", "ЭКРАН",
    
    # Фото и видео
    "ФОТО", "СНИМОК", "АЛЬБОМ", "РАМКА", "КАДР", "ВИДЕО", "КЛИП", "ФИЛЬМ",
    "КАМЕРА", "ОБЪЕКТИВ", "ВСПЫШКА", "СТУДИЯ", "ФОТОЗОНА", "ДЕКОР", "ФОН",
    
    # Декор и оформление
    "ЦВЕТОК", "РОЗА", "ПИОН", "ТЮЛЬПАН", "ОРХИДЕЯ", "ГИПСОФИЛА", "ЭВКАЛИПТ",
    "ГИРЛЯНДА", "ЛЕНТА", "БАНТ", "ШАР", "ВОЗДУШНЫЙ", "ГЕЛИЙ", "КОНФЕТТИ",
    "СЕРПАНТИН", "СТОЛБ", "АРКА", "КОЛОННА", "ПОДСТАВКА", "ВАЗОН", "КОРЗИНА",
    
    # Транспорт
    "ЛИМУЗИН", "КАРЕТА", "АВТОМОБИЛЬ", "МАШИНА", "КОЛОННА", "КОРТЕЖ", "ПРОЦЕССИЯ",
    
    # Время и дата
    "ДЕНЬ", "НОЧЬ", "УТРО", "ВЕЧЕР", "МЕСЯЦ", "ГОД", "ДАТА", "ВРЕМЯ", "ЧАС",
    "МИНУТА", "МОМЕНТ", "МИГ", "ПАМЯТЬ", "ВОСПОМИНАНИЕ", "ИСТОРИЯ", "ЛЕГЕНДА",
    
    # Эмоции и чувства
    "УЛЫБКА", "СМЕХ", "СЛЕЗА", "ВОСТОРГ", "ВОЛНЕНИЕ", "ТРЕПЕТ", "ТРЕВОГА",
    "НАДЕЖДА", "ВЕРА", "МЕЧТА", "ЖЕЛАНИЕ", "СТРЕМЛЕНИЕ", "ЦЕЛЬ", "ПЛАН",
    
    # Еда и напитки
    "ЗАКУСКА", "САЛАТ", "СУП", "ГОРЯЧЕЕ", "ГАРНИР", "МЯСО", "РЫБА", "КУРИЦА",
    "ОВОЩ", "ФРУКТ", "ЯГОДА", "ХЛЕБ", "БУЛОЧКА", "ПИРОГ", "ПИРОЖОК", "БЛИН",
    "НАПИТОК", "СОК", "ЛИМОНАД", "КОМПОТ", "МОРС", "КОКТЕЙЛЬ", "КОФЕ", "ЧАЙ",
    
    # Дополнительные понятия
    "ТРАДИЦИЯ", "ОБЫЧАЙ", "РИТУАЛ", "ЦЕРЕМОНИЯ", "ПРОЦЕДУРА", "ЭТАП", "МОМЕНТ",
    "ДЕТАЛЬ", "МЕЛОЧЬ", "НЮАНС", "ОСОБЕННОСТЬ", "ХАРАКТЕРИСТИКА", "КАЧЕСТВО",
    "ПРЕИМУЩЕСТВО", "ДОСТОИНСТВО", "ДОБРОТА", "ЧЕСТНОСТЬ", "ВЕРНОСТЬ", "ПРЕДАННОСТЬ",
    "ЗАБОТА", "ВНИМАНИЕ", "УВАЖЕНИЕ", "ПОЧИТАНИЕ", "БЛАГОДАРНОСТЬ", "ПРИЗНАНИЕ",
    "ОДОБРЕНИЕ", "ПОДДЕРЖКА", "ПОМОЩЬ", "СОДЕЙСТВИЕ", "СОТРУДНИЧЕСТВО", "ПАРТНЕРСТВО",
    "ДРУЖБА", "ТОВАРИЩЕСТВО", "ЕДИНЕНИЕ", "СПЛОЧЕННОСТЬ", "СОГЛАСИЕ", "ГАРМОНИЯ",
    "БАЛАНС", "РАВНОВЕСИЕ", "СТАБИЛЬНОСТЬ", "НАДЕЖНОСТЬ", "ПОСТОЯНСТВО", "ПРОЧНОСТЬ",
    "ДОЛГОВЕЧНОСТЬ", "ВЕЧНОСТЬ", "БЕСКОНЕЧНОСТЬ", "БЕЗГРАНИЧНОСТЬ", "БЕЗУСЛОВНОСТЬ",
    "БЕЗОГОВОРОЧНОСТЬ", "АБСОЛЮТНОСТЬ", "ПОЛНОТА", "ЦЕЛОСТНОСТЬ", "ЕДИНСТВО",
    "ЦЕЛЬНОСТЬ", "НЕРАЗРЫВНОСТЬ", "НЕРАЗДЕЛИМОСТЬ", "НЕРАЗЛУЧНОСТЬ", "НЕРАСТОРЖИМОСТЬ"
]

def add_words_to_sheet():
    """Добавить слова в таблицу Wordle"""
    try:
        client = get_google_sheets_client()
        if not client:
            logger.error("Не удалось получить клиент Google Sheets")
            return False
        
        spreadsheet = client.open_by_key(GOOGLE_SHEETS_ID)
        
        try:
            sheet = spreadsheet.worksheet("Wordle")
        except Exception:
            logger.error("Вкладка 'Wordle' не найдена")
            return False
        
        # Получаем существующие слова
        existing_values = sheet.get_all_values()
        existing_words = set()
        for row in existing_values[1:]:  # Пропускаем заголовок
            if row and len(row) > 0 and row[0].strip():
                existing_words.add(row[0].strip().upper())
        
        # Добавляем только новые слова
        new_words = []
        for word in WEDDING_WORDS:
            if word.upper() not in existing_words:
                new_words.append([word])
        
        if new_words:
            # Добавляем слова батчами по 100 (лимит API)
            batch_size = 100
            for i in range(0, len(new_words), batch_size):
                batch = new_words[i:i + batch_size]
                sheet.append_rows(batch)
                logger.info(f"Добавлено {len(batch)} слов (батч {i // batch_size + 1})")
            
            logger.info(f"Всего добавлено {len(new_words)} новых слов из {len(WEDDING_WORDS)}")
        else:
            logger.info("Все слова уже присутствуют в таблице")
        
        return True
    except Exception as e:
        logger.error(f"Ошибка добавления слов: {e}")
        import traceback
        logger.error(traceback.format_exc())
        return False

if __name__ == "__main__":
    logger.info("Начинаем добавление слов в таблицу Wordle...")
    success = add_words_to_sheet()
    if success:
        logger.info("Слова успешно добавлены!")
    else:
        logger.error("Ошибка при добавлении слов")
        sys.exit(1)

